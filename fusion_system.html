<!DOCTYPE html>
<!--
	Landed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Ian Gerrits-Portfolio/FusionSystem</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript
      ><link rel="stylesheet" href="assets/css/noscript.css"
    /></noscript>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
  </head>
  <body class="is-preload">
    <div id="page-wrapper">
      <!-- Header -->
      <header id="header">
        <h1 id="logo"><a href="index.html">Ian Gerrits - Portfolio</a></h1>
        <nav id="nav">
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about_me.html">About Me</a></li>
            <li>
              <a href="projects.html"
                >Projects <i class="arrow down_arrow"></i
              ></a>
              <ul>
                <li><a href="wretched_depths.html">Wretched Depths</a></li>
                <li><a href="khestoria.html">Khestoria</a></li>
                <li><a href="raising_hell.html">Raising Hell</a></li>
                <li>
                  <a href="exploding_barnacle.html"
                    >Project: Exploding Barcacle</a
                  >
                </li>
                <li>
                  <a href="fusion_system.html">UE5 Fusion System</a>
                </li>
              </ul>
            </li>
            <li><a href="files/resume.pdf" target="_blank">Resume</a></li>
            <li>
              <a href="contact.html" class="button primary">Contact me</a>
            </li>
          </ul>
        </nav>
      </header>

      <!-- Intro -->
      <section id="intro">
        <center>
          <div class="text">
            <header>
              <h2>
                <br />
                <a
                  href="exploding_barnacle.html"
                  class="scroll_arrow left_arrow"
                ></a>
                UE5 Fusion System
                <a
                  href="wretched_depths.html"
                  class="scroll_arrow right_arrow"
                ></a>
              </h2>
            </header>
            <div>Project Info</div>
            <div>
              Role: Gameplay Programmer<br />
              Type: Physics System<br />
              Team Size: 1<br />
              Timeline: Currently in progress<br />
              Engine: Unreal Engine 5 (C++, Blueprints)<br />
              Repo:
              <a href="https://github.com/igerrits13/TotK_BuildSystem">
                Github Repo</a
              ><br />
            </div>
            <br />
            <div>About</div>
            <div>
              Inspired by The Legend of Zelda: Tears of the Kindgom Ultrahnd's
              mechanic, I want to create my own dynamic fusion system where
              players could make their own custom contraptions. This project is
              meant to get more familiar with Unreal Engine 5 and all it has to
              offer.
            </div>
          </div>
          <br />
          <!-- <div>
            *Short video of finished fusion system building a cart and moving*
          </div> -->
        </center>
      </section>
      <br />
      <!-- Details -->
      <section id="details">
        <center>
          <h2>Goal</h2>
          <div class="text">
            I want to create a dynamic object fusion system that allows players
            to pickup, snap together, and fuse objects into one unique
            contraption of their own design while also being able to break those
            objects apart back into individual pieces. Through this project, I
            will familiarize myself with Unreal Engine 5, get a better
            understanding of programming using C++ and how Unreal scripts
            integrate with blueprints, learn how to utilize Unreal's powerful
            built in physics system, increase my 3-D math skills, and discover
            new methods for debugging complex actor interactions.
          </div>
          <br />
        </center>
        <center>
          <h2>Player Interaction</h2>
          <h3>Object Grabbing, Transform and Player Feedback</h3>
          <div class="text">
            A key element of creating this fusion system is allowing the player
            to pick up and manipulate objects in 3-D space. While the player is
            interacting with the object, I wanted to give feedback showing the
            player what object is currently held and if it is able to be fused
            with another nearby object. This is achieved using a custom overlay
            material that will show red if not able to fuse and green if there
            is a valid nearby object to fuse with.
          </div>
          <br />
          <!-- <div>GIF OF ROTATING SINGLE OBJECT WHILE RED</div> -->
          <br />
          <h3>Object Connection Points and Interpolation</h3>
          <div class="text">
            To allow objects to fuse together, they had to visually align with
            each other in space. To achieve this, I started by simply snapping
            the object that the player was holding to the location of the object
            to be fused with. However, this led to the objects simply
            overlapping with each other and flying off into space due to their
            collision. To remedy this, I decided to disable collision when
            fusing objects together to avoid them from producing a random
            behaviour such as flying around the map. Beyond this, I wanted to
            align the objects more naturally. For my next attempt, I chose to
            align objects by getting their location and adding the distance from
            that location to the hit location of the box extent for both the
            held object and the object being fused with. This seemed to work
            well to begin with but quickly fell apart when the objects were
            rotated in any way that altered the mesh's box extent from being
            accurate. For my next attempt, I chose to implement the closest
            point on collision function. This allowed me to get the closest
            point from the held object to the other object. After getting this
            collision point, I would do another call to the closest point on
            collision function from the initial stored point back to the held
            object, giving intuitive points for the objects to fuse at. To
            resolve the snapping, I utilized the tick function to implement a
            simple interpolation to move the held object to the other object it
            is fusing with, allowing for an offset between objects to avoid
            collision with each other. After this is all done, collision is
            enabled once again.
          </div>
          <br />
          <!-- <div>GIF OF OBJECT FUSING WITH OTHER OBJECT</div> -->
          <br />
          <h3>Getting the Closest Object of Many</h3>
          <div class="text">
            While experiementing with connecting objects togher, I quickly
            realized that there was an issue with how the non-held object was
            chosen to be fused. So far, a held object would have a collision box
            where there was a check to see if there were any overlapping actors
            within that box. From there, a line trace was done to each
            overlapping actor to check if it was an object that could be fused
            with, and the first object passing this check was selected for
            fusing. Thinking of Ultrahand in ToTK, the closest object is always
            chosen to fuse with, which feels more natural and gives greater
            control to the player, a sensation that I wanted to match. To
            resolve this was a relatively simple fix. For each overlapping
            actor, I would check the distance between the held object and the
            current overlapping object, if it was the first or was closer than
            the previously closest object, it is stored as the current closest
            object. Each overlapping actor is tested and the closest one is
            returned as the closest fuseable object.
          </div>
          <br />
          <!-- <div>
            GIF OF OBJECT CHECKING DISTANCE OF MULTIPLE POTENTIAL ACTORS
          </div> -->
          <br />
        </center>
        <br />
        <center>
          <h2>Fusion System</h2>
          <h3>Fusing Objects Together at a Technical Level</h3>
          <div class="text">
            At this point the objects appeared to be fused together and
            everything was going great. However, this illusion quickly fell
            apart when the player went to pick up a fused object and the other
            object it is fused to did not follow. In turn, I needed to actually
            fuse the objects togher in a way that Unreal would be able to see.
            The first thought that came to my mind was to simply continuing to
            update fused objects based on the previously mentioned connection
            points, but it did not take much to realize that would become
            cumbersome in terms of calculations as well as needlessly complex
            when fusing multiple objects together.
            <br />
            After some research I came across Physics Constraint Components,
            Unreal Engine's method for handling a physics system such as this
            that allows for a range of freedom of motion and rotation between
            linked objects. This allowed for fused objects to move in space
            together while still have limited independent movement as well.
            During implementation of logically fusing the objects, things did
            end up breaking temporarily though. To keep track of all the other
            objects a single moveable object was fused with I created a pointer
            array that would keep track of other moveable objects. After
            creating this array, I noticed that the player was no longer able to
            fuse objects, nearby objects were not being detected and materials
            were no longer being applied. After doing some research, I found
            that there was some differences between the constructor function and
            begin play function. To begin with, I initialized the array to only
            contain itself since a object will alway be fused with itself, which
            was done in the constructor. After printing out the name of the
            object in the array, I found that it was a generic object of the
            moveable object type rather than the object itself. After looking
            around online, I found that this is the behavior that occurs before
            an object has been created and since the object was not fully
            created by the time the constructor was running, a generic version
            of the object was added to the array instead. To resolve this issue,
            I moved the initialization of the array into the begin play function
            when the object itself had already been fully created.
          </div>
          <br />
          <!-- <div>GIF OF MULTIPLE OBJECTS BEING PICKED UP AND MOVED TOGETHER</div> -->
          <br />
          <h3>
            Fusing as a Single Contraption and Returning the Closest Object out
            of all Fused Objects
          </h3>
          <div class="text">
            Now that objects were properly fusing together both visually and
            from a physics perspective, there was a new challenge with fusing
            multiple objects together. At this point, only the held object was
            checking for nearby objects to fuse with and any objects that the
            held object was already fused with were ignored, leading to the
            player not being able to fuse with other objects if there was an
            already fused object between the held and nearby moveable objects.
            To allow for better fusion I chose to simply expand the already
            existing logic. Now, each object in the fused object array would
            return their closest moveable object. From there, each distance
            would be compared to get the closest pair out of the fused object
            and their closest non-fused object.
          </div>
          <br />
          <!-- <div>
            GIF OF MULTIPLE OBJECTS CHECKING MULTIPLE NON FUSED OBJECTS AND
            HIGHLIGHTING THE CLOSEST ONE
          </div> -->
          <br />
          <h3>Custom Links and Breaking Apart Fused Objects</h3>
          <div class="text">
            The last major feature of this system that I wanted to incorperate
            was the option to break apart fused objects so the player really
            could create any contraption they wanted without fear of making a
            mistake. Up to this point, fused objects were tracked very well, but
            the physics constraints that held objects together were not, making
            it so even if objects were moved from each other's fused object
            arrays, they would still be constrained to each other. This led to
            the creation of a custom physics link struct that holds pointers to
            the two fused objects as well as the constraint keeping them
            together. Then, each object also got their own array to hold these
            links. With these links now tracked, it was easy to break apart a
            held object from all others by emptying the array holding the links.
            <br />
            By this point in the project I had started to create a bigger
            emphasis on planning before coding, and during this planning I
            realized clearing the array was an easy solution for any end object,
            say a board that is fused to the end of an arbitrary length of other
            boards. However, I needed a way to allow for breaking a board from
            the middle of that fused contraption. With this in mind, I decided
            that breaking everything down and rebuilding would be the easiest
            and safest way to ensure only the held object is split from the
            other fused objects, and any fused groups on either side of the held
            object would stay together. To being, I removed all the physics
            links from the held object since it was going to be a single object
            again. Next, I iterated over all objects within the fused object
            array except for the held object itself, clearing the array so it
            was empty except itself. After this, since the held object still had
            references to previously fused objects within its array, each of
            those objects would be updated to add the objects it was directly
            fused to, as well as any objects that newly fused object was already
            fused with. Since each object has its own array of constraint links,
            this was simple. After this was done, all objects from the held
            objects fused array would add their still fused objects either
            directly through their constraint links or vicariously through the
            newly fused object.
          </div>
          <br />
          <!-- <div>
            GIF OF MULTIPLE OBJECTS BREAKING APART AND SHOWING THAT THERE ARE
            NOW THREE SEPERATE CONTRAPTIONS
          </div> -->
          <br />
          <h2>Conclusion</h2>
          <div class="text">
            This system is still a work in progress and will be updated as I am
            able. In its current state, this system demonstrates a understanding
            of how gameplay mechanics can be built from the ground up using C++
            utilizing the physics system within Unreal Engine 5. I see this
            project as a showcase of my ability to design and implement complex
            gameplay systems.
            <br />
            From here, I will work to polish fusing with snapping to properly
            align fused objects and finish implementation of different object
            types such as wheels and fans.
          </div>
        </center>
      </section>

      <!-- Footer -->
      <footer id="footer">
        <ul class="icons">
          <li>
            <a
              href="https://www.linkedin.com/in/ian-gerrits-3764ab1a1/"
              target="_blank"
              class="tooltip icon brands alt fa-linkedin"
              ><span class="tooltiptext">LinkedIn</span></a
            >
          </li>
          <li>
            <a
              href="https://github.com/igerrits13"
              target="_blank"
              class="tooltip icon brands alt fa-github"
              ><span class="tooltiptext">GitHub</span></a
            >
          </li>
          <li>
            <a
              href="mailto:igerrits@yahoo.com"
              class="tooltip icon solid alt fa-envelope"
              ><span class="tooltiptext">Email</span></a
            >
          </li>
        </ul>
        <ul class="copyright">
          <li>
            Email: <a href="mailto:igerrits@yahoo.com">igerrits@yahoo.com</a>
          </li>
          <li>&copy; Ian Gerrits-Portfolio. All rights reserved.</li>
          <li>
            Layout inspired by
            <a href="http://www.arashshirazi.co.uk/" target="_blank"
              >Ary Shirazi</a
            >
          </li>
          <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        </ul>
      </footer>
    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <!-- Swiper -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="assets/js/swiper.js"></script>
  </body>
</html>
